---
description: æ£€æŸ¥ä»»åŠ¡éªŒæ”¶æ ‡å‡†å¹¶æ›´æ–°çŠ¶æ€
Argument-hint: [ä»»åŠ¡IDï¼Œå¯é€‰]
---

# éªŒæ”¶æ£€æŸ¥

## ç¬¬ä¸€æ­¥ï¼šç¡®å®šè¦éªŒè¯çš„ä»»åŠ¡

**æƒ…å†µ Aï¼šæä¾›äº† $ARGUMENTS**
- ç›´æ¥éªŒè¯æŒ‡å®šçš„ä»»åŠ¡ID

**æƒ…å†µ Bï¼šæœªæä¾› $ARGUMENTS**
- ä½¿ç”¨ **TaskList** å·¥å…·è·å–å½“å‰ä»»åŠ¡åˆ—è¡¨
- æ‰¾åˆ° `status: "in_progress"` çš„ä»»åŠ¡
- å¦‚æœæœ‰å¤šä¸ªï¼Œè¯¢é—®ç”¨æˆ·éªŒè¯å“ªä¸€ä¸ª

## ç¬¬äºŒæ­¥ï¼šè¯»å–éªŒæ”¶æ ‡å‡†

ä» `.workflow/criteria.json` è¯»å–è¯¥ä»»åŠ¡çš„ `acceptance_criteria`ã€‚

**å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨æˆ–ä»»åŠ¡æ²¡æœ‰éªŒæ”¶æ ‡å‡†**ï¼š
```
è¯¥ä»»åŠ¡æ²¡æœ‰è®¾ç½®éªŒæ”¶æ ‡å‡†ã€‚
1. ç«‹å³è®¾ç½®éªŒæ”¶æ ‡å‡†
2. è·³è¿‡éªŒæ”¶ï¼Œç›´æ¥æ ‡è®°å®Œæˆï¼ˆä¸æ¨èï¼‰

è¯·é€‰æ‹©: 1 æˆ– 2
```

## ç¬¬ä¸‰æ­¥ï¼šæ‰§è¡ŒéªŒè¯

éå†æ¯æ¡éªŒæ”¶æ ‡å‡†ï¼š

### type: "auto"

è¿è¡Œ `verify` å­—æ®µä¸­çš„å‘½ä»¤ï¼š
- ä½¿ç”¨ **Bash å·¥å…·** æ‰§è¡Œå‘½ä»¤
- **è¯»å– `timeout` å­—æ®µ**ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ï¼Œå¦åˆ™ä½¿ç”¨é»˜è®¤å€¼ 120 ç§’
- **æˆåŠŸ**ï¼ˆexit code 0ï¼‰â†’ æ›´æ–° `passed: true`
- **å¤±è´¥**ï¼ˆexit code â‰  0ï¼‰â†’ ä¿æŒ `passed: false`ï¼Œè®°å½•è¾“å‡º
- **è¶…æ—¶** â†’ ä¿æŒ `passed: false`ï¼Œæ ‡è®°ä¸ºè¶…æ—¶

**ç¤ºä¾‹ 1ï¼šé»˜è®¤è¶…æ—¶ï¼ˆ120ç§’ï¼‰**
```json
{
  "criterion": "æµ‹è¯•é€šè¿‡",
  "type": "auto",
  "verify": "pytest tests/ -q",
  "passed": false
}
```
æ‰§è¡Œï¼š
```bash
pytest tests/ -q
# ä½¿ç”¨é»˜è®¤è¶…æ—¶ 120 ç§’
```

**ç¤ºä¾‹ 2ï¼šè‡ªå®šä¹‰è¶…æ—¶ï¼ˆ600ç§’ = 10åˆ†é’Ÿï¼‰**
```json
{
  "criterion": "é›†æˆæµ‹è¯•é€šè¿‡",
  "type": "auto",
  "verify": "npm run integration-test",
  "timeout": 600,
  "passed": false
}
```
æ‰§è¡Œï¼š
```bash
npm run integration-test
# ä½¿ç”¨è‡ªå®šä¹‰è¶…æ—¶ 600 ç§’
```

**ç¤ºä¾‹ 3ï¼šå¿«é€Ÿå‘½ä»¤ï¼ˆ10ç§’ï¼‰**
```json
{
  "criterion": "ä»£ç æ£€æŸ¥",
  "type": "auto",
  "verify": "npm run lint",
  "timeout": 10,
  "passed": false
}
```
æ‰§è¡Œï¼š
```bash
npm run lint
# ä½¿ç”¨è‡ªå®šä¹‰è¶…æ—¶ 10 ç§’
```

**è¶…æ—¶å¤„ç†**ï¼š
å¦‚æœå‘½ä»¤æ‰§è¡Œè¶…è¿‡è®¾å®šçš„è¶…æ—¶æ—¶é—´ï¼š
- âš ï¸ æ˜¾ç¤ºè­¦å‘Šï¼š`éªŒè¯å‘½ä»¤æ‰§è¡Œè¶…æ—¶ ({timeout}ç§’)`
- ğŸ“ è®°å½•åˆ°è¾“å‡ºä¸­
- âŒ ä¿æŒ `passed: false`
- ğŸ’¡ æç¤ºï¼šå¯ä»¥å¢åŠ è¶…æ—¶æ—¶é—´æˆ–ä¼˜åŒ–å‘½ä»¤

**ä¼˜å…ˆä½¿ç”¨å†…ç½®æŠ€èƒ½**ï¼š
- å¦‚æœ verify å‘½ä»¤æ˜¯æµ‹è¯•ç›¸å…³ï¼Œä¼˜å…ˆè°ƒç”¨ `/test:run`
- å¦‚æœ verify å‘½ä»¤æ˜¯ git ç›¸å…³ï¼Œä¼˜å…ˆè°ƒç”¨ `/git:commit`

### type: "manual"

**è¯¢é—®ç”¨æˆ·**ï¼š
```
æ˜¯å¦æ»¡è¶³ï¼š{criterion}ï¼Ÿ

å›å¤:
- y / yes / ç¡®è®¤ â†’ æ ‡è®°ä¸ºé€šè¿‡
- n / no / ä¸é€šè¿‡ â†’ æ ‡è®°ä¸ºå¤±è´¥
```

æ ¹æ®ç”¨æˆ·å›ç­”ï¼Œæ›´æ–° `passed` å­—æ®µã€‚

## ç¬¬å››æ­¥ï¼šæ›´æ–°çŠ¶æ€

### è®¡ç®—é€šè¿‡ç‡

```python
total = len(acceptance_criteria)
passed = sum(1 for c in acceptance_criteria if c["passed"])
```

### æƒ…å†µ Aï¼šå…¨éƒ¨é€šè¿‡ (passed == total)

1. **æ›´æ–°éªŒæ”¶æ ‡å‡†æ–‡ä»¶**ï¼š
   - å°†æ‰€æœ‰ `passed` è®¾ä¸º `true`
   - ä¿å­˜åˆ° `.workflow/criteria.json`

2. **æ›´æ–°ä»»åŠ¡çŠ¶æ€**ï¼š
   - ä½¿ç”¨ **TaskUpdate** å·¥å…·
   - å°†ä»»åŠ¡æ ‡è®°ä¸º `completed`
   - å‚æ•°ï¼š`{"taskId": "ä»»åŠ¡ID", "status": "completed"}`

3. **è¾“å‡ºç»“æœ**ï¼š
   ```
   âœ… éªŒæ”¶é€šè¿‡ï¼Œä»»åŠ¡å·²å®Œæˆ

   éªŒæ”¶æ ‡å‡†: 2/2 é€šè¿‡
     âœ… æµ‹è¯•é€šè¿‡ (auto)
     âœ… ä»£ç å®¡æŸ¥ (manual)

   ä»»åŠ¡çŠ¶æ€å·²æ›´æ–°ä¸º: completed
   ```

### æƒ…å†µ Bï¼šéƒ¨åˆ†é€šè¿‡ (passed < total)

1. **æ›´æ–°éªŒæ”¶æ ‡å‡†æ–‡ä»¶**ï¼š
   - ä¿å­˜é€šè¿‡çš„é¡¹ç›®
   - æœªé€šè¿‡çš„é¡¹ç›®ä¿æŒ `passed: false`

2. **ä¿æŒä»»åŠ¡çŠ¶æ€**ï¼š
   - ä¿æŒ `in_progress` çŠ¶æ€
   - ä¸è¦è°ƒç”¨ TaskUpdate

3. **è¾“å‡ºç»“æœ**ï¼š
   ```
   âŒ éªŒæ”¶æœªé€šè¿‡ï¼Œä»»åŠ¡ä¿æŒè¿›è¡Œä¸­

   éªŒæ”¶æ ‡å‡†: 1/2 é€šè¿‡
     âœ… æµ‹è¯•é€šè¿‡ (auto)
     âŒ ä»£ç å®¡æŸ¥ (manual) â† æœªé€šè¿‡

   è¯·ä¿®å¤æœªé€šè¿‡é¡¹åï¼Œå†æ¬¡è¿è¡Œ /workflow:verify
   ```

## ç¬¬äº”æ­¥ï¼šåŒæ­¥åˆ°æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰

å¦‚æœé…ç½®äº† `auto_sync`ï¼Œè‡ªåŠ¨è°ƒç”¨ hooks.py åŒæ­¥åˆ° `.workflow/state.json`ã€‚

---

## å®Œæ•´ç¤ºä¾‹

### åœºæ™¯ï¼šè‡ªåŠ¨éªŒè¯ + æ‰‹åŠ¨éªŒè¯

```bash
ç”¨æˆ·: /workflow:verify

Claude:
1. TaskList â†’ æ‰¾åˆ° task-003 (in_progress)
2. è¯»å– criteria.json â†’ 2 æ¡éªŒæ”¶æ ‡å‡†
3. æ‰§è¡ŒéªŒè¯ï¼š
   - auto: pytest tests/auth.test.py
     â†’ æ‰§è¡ŒæˆåŠŸ â†’ passed: true
   - manual: è¯¢é—®ç”¨æˆ·
     â†’ ç”¨æˆ·å›å¤ yes â†’ passed: true
4. å…¨éƒ¨é€šè¿‡ â†’ TaskUpdate: status="completed"
5. è¾“å‡ºï¼šâœ… task-003 éªŒæ”¶é€šè¿‡
```

### åœºæ™¯ï¼šéªŒè¯å¤±è´¥

```bash
ç”¨æˆ·: /workflow:verify

Claude:
1. è¯»å– task-004 â†’ 3 æ¡éªŒæ”¶æ ‡å‡†
2. æ‰§è¡ŒéªŒè¯ï¼š
   - auto: npm run build
     â†’ å¤±è´¥ â†’ passed: false
     â†’ é”™è¯¯ä¿¡æ¯ï¼šTypeScript compilation failed
   - auto: npm run lint
     â†’ æˆåŠŸ â†’ passed: true
   - manual: è¯¢é—®ç”¨æˆ·
     â†’ ç”¨æˆ·å›å¤ yes â†’ passed: true
3. éƒ¨åˆ†é€šè¿‡ â†’ ä¿æŒ in_progress
4. è¾“å‡ºï¼š
   ```
   âŒ éªŒæ”¶æœªé€šè¿‡

   é€šè¿‡: 2/3
     âœ… ä»£ç æ£€æŸ¥ (auto)
     âœ… åŠŸèƒ½ç¡®è®¤ (manual)
     âŒ æ„å»ºæˆåŠŸ (auto) â† å¤±è´¥

   é”™è¯¯: TypeScript compilation failed
   è¯·ä¿®å¤åé‡æ–°éªŒè¯
   ```
```

---

## é”™è¯¯å¤„ç†

### ä»»åŠ¡ä¸å­˜åœ¨
```
âŒ é”™è¯¯: æœªæ‰¾åˆ°ä»»åŠ¡ {taskID}

ä½¿ç”¨ /workflow:status æŸ¥çœ‹æ‰€æœ‰ä»»åŠ¡
```

### criteria.json æ ¼å¼é”™è¯¯
```
âŒ é”™è¯¯: criteria.json æ ¼å¼æ— æ•ˆ

è¯·æ£€æŸ¥ JSON æ ¼å¼ï¼Œæˆ–åˆ é™¤è¯¥æ–‡ä»¶é‡æ–°åˆ›å»º
```

### auto éªŒè¯å‘½ä»¤æ‰§è¡Œè¶…æ—¶
```
âš ï¸  è­¦å‘Š: éªŒè¯å‘½ä»¤æ‰§è¡Œè¶…æ—¶ (120s)

å‘½ä»¤: npm test
å»ºè®®: æ£€æŸ¥å‘½ä»¤æ˜¯å¦éœ€è¦æ›´é•¿æ—¶é—´ï¼Œæˆ–æ‰‹åŠ¨éªŒè¯

è·³è¿‡æ­¤é¡¹? (y/n)
```
